(function(){define(["babylon","c/bentity"],function(){var t;return t=function(){function t(t){null==t&&(t={}),this.defaults={pos:[0,0,0],emit:function(){},limit:1,interval:1},this.opts=_.extend(this.defaults,t),this.spawned=0,this.entities=[],this.onStageEnts=[]}return t.prototype.attach=function(t){return this.scene=t},t.prototype.update=function(t){var i,n,s,e,o;for(!(t%this.opts.interval)&&this.spawned<this.opts.limit&&(this.spawned=this.emit()),e=this.onStageEnts,o=[],n=0,s=e.length;s>n;n++)i=e[n],o.push(this.opts.update(i,t));return o},t.prototype.emit=function(){return this.spawned=this.opts.emit(this.scene,this.entities,this.opts.limit,this.spawned,this.onStageEnts)},t.prototype.addToPool=function(t){return this.entities.push(t)},t}()})}).call(this);