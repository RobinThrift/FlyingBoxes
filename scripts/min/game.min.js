(function(){requirejs.config({baseUrl:"/scripts/vendor",paths:{c:"../components",babylon:"babylon.1.6.0"},shim:{lodash:{exports:"_"},"KeyboardJS/keyboard.js":{exports:"KeyboardJS"},babylon:{exports:"BABYLON",deps:["hand-1.1.3"]},zepto:{exports:"$"}}}),requirejs(["babylon","KeyboardJS/keyboard","zepto","lodash","c/bits","c/stage","c/camera","c/light","c/spawner","c/bentity","c/gui/bar"],function(o,e,t,n,r,i,a,s,d,c,l){var p,g,u,b,h,y,m,w,x,f,v,P,L,j,X,z,O,T;return p=5,g=5,m=100,b=function(){return m-=1,0>=m&&(m=100),v.update(m+"%")},w=100,h=function(){return w-=1,0>=w&&(w=100),P.update(w+"%")},v=new l("player1LifeBar",{x:10,y:10,colour:"red",pos:"right",height:"35px",width:"200px"}),v.attach(),P=new l("player2LifeBar",{x:10,y:10,colour:"green",pos:"left",height:"35px",width:"200px"}),P.attach(),T=new i("screen"),L=new c("player","box",{size:.4,pos:[1,-3.5,0],Zscaling:.3,Xscaling:2,Yscaling:1.1,colour:{r:1,g:0,b:.23}},{left:function(){return L.getPosition().x>-p?L.move(-.2):void 0},right:function(){return L.getPosition().x<g?L.move(.2):void 0}},j=new c("player2","box",{size:.4,pos:[-1,-3.5,0],Zscaling:.3,Xscaling:2,Yscaling:1.1,colour:{r:.1,g:1,b:.1}},{a:function(){return j.getPosition().x>-p?j.move(-.2):void 0},d:function(){return j.getPosition().x<g?j.move(.2):void 0}}),u=new c("bgPlane","plane",{size:100,pos:[0,0,20],specularColour:{r:1,g:0,b:.23},colour:{r:1,g:.4,b:.1}})),x=new a("mainCam","free",{pos:[0,0,-10],controls:!1}),f=new s("hemi","mainLight",{pos:[0,0,0],colour:r.rgbToFloatObj(144,202,97)}),X=new s("spot","spot1",{pos:[-3,-2,-2],to:[0,-1.5,2],debug:!1,angle:10,decay:1,colour:r.rgbToFloatObj(221,24,52)}),X.dirX=2.5,X.update=function(e){return e.light.position.x>40?e.dirX=-2.5:e.light.position.x<-40&&(e.dirX=2.5),e.light.position.addInPlace(new o.Vector3(e.dirX,0,0))},z=new s("spot","spot2",{pos:[0,-2,-2],to:[0,-1.5,2],debug:!1,angle:10,decay:10,colour:r.rgbToFloatObj(255,0,255)}),O=new s("spot","spot3",{pos:[3,-2,-2],to:[0,-1.5,2],debug:!1,angle:10,decay:10,colour:r.rgbToFloatObj(0,0,255)}),y=new d({limit:200,interval:30,emit:function(o,e,t,n,i){var a,s,d,l,p;for(l=0,p=e.length;p>l;l++)a=e[l],t>n&&(d=new c("b",a.type,a),i.push(d),T.addEntity(d),s=r.randInt(0,3),Math.random()>.5||(s=-s),d.setPosition(s,10,0),n++);return n},update:function(e){var t;return L.mesh.intersectsMesh(e.mesh,!1)&&b(),j.mesh.intersectsMesh(e.mesh,!1)&&h(),e.mesh.rotation.addInPlace(new o.Vector3(-.1,-.1,-.01)),e.getPosition().y>-8?e.move(0,-.15,0):(t=r.randInt(0,10),Math.random()>.5||(t=-t),e.setPosition(t,10,0))}}),y.addToPool({type:"box",size:.2,pos:[0,0,0],Zscaling:1,Xscaling:1,Yscaling:1,colour:{r:.1,g:.23,b:1}}),T.addSpawner(y),T.addCamera(x),T.addLight(f),T.addLight(X),T.addLight(z),T.addLight(O),T.addEntity(L),T.addEntity(j),T.addEntity(u),T.loop()})}).call(this);